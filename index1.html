<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>MyPets</title>
  <link href="https://fonts.googleapis.com/css?family=Poppins:300,300i,500,500i,700|Barriecito" rel="stylesheet">
  <link rel="stylesheet" href="./style1.css">

</head>

<body>

  <main>
    <section>
      <nav>
        <div class="logo">
          <div class="text">MyPets</div>
        </div>
        </div>
        </div>
      </nav>
      <div class="dog-info">
        <section class="dog-name">
          <div class="dog-name__info">
            <h1 id="cod">.</h1>
          </div>
        </section>
        <section class="dog-gallery">
          <input class="dog-gallery__input" id="gallery-image-1" type="radio" value="1" name="dog-image"
            checked="checked" />
          <div class="dog-gallery__images"><img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/567707/malamute1.jpg"
              alt="Dog Image" /><img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/567707/malamute2.jpg"
              alt="Dog Image" /><img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/567707/malamute3.jpg"
              alt="Dog Image" /><img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/567707/malamute4.jpg"
              alt="Dog Image" /></div>
        </section>
        <section class="dog-manythings">
          <div class="dog-manythings__stats">
            <p>Nombre </p>
            <h5 id="Nom"> .</h5>
          </div>
          <div class="dog-manythings__stats">
            <p>Fecha de nacimiento </p>
            <h5 id="Fech">.</h5>
          </div>
          <div class="dog-manythings__stats">
            <p>Departamento</p>
            <h5 id="Dep">.</h5>
          </div>
          <div class="dog-manythings__stats">
            <p>Municipio</p>
            <h5 id="Mun">.</h5>
          </div>
          <div class="dog-manythings__stats">
            <p>Dirección</p>
            <h5 id="Direc">.</h5>
          </div>
          <div class="dog-manythings__more">
            <h3>Mas información</h3>
            <p> <strong>Contacto </strong>
            <h5 id="Contc">.</h5>
            </p>
            <p> <strong>Email </strong>
            <h5 id="Ema">.</h5>
            </p>

            <div class="dog-manythings__more">
              <h3>Registro de vacunas</h3>
            </div>

            <div class="dog-manythings__more">
              <h3>
                <table class="container">
                  <thead>
                    <tr>
                      <th>
                        <h1>Vacunas</h1>
                      </th>
                      <th>
                        <h1>Fecha colocada</h1>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td id="vac">.</td>
                      <td id="fechacoloc">.</td>
                    </tr>
                  </tbody>
                </table>
              </h3>
            </div>
        </section>


        <script>
          // Función para obtener parámetros de la URL por nombre
          function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            const regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
              results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return "";
            return decodeURIComponent(results[2].replace(/\+/g, " "));
          }

          // Obtiene el código de la mascota de los parámetros de la URL
          const codigoMascota = getParameterByName("codigoMascota");

          // Verifica si se proporcionó el código de la mascota en la URL
          if (codigoMascota) {
            // Realiza una solicitud a tu API para obtener los datos de la mascota
            const apiUrl = "http://localhost/MyPets_Admin/servicios/prc/prc_mascota.php?accion=C&codigo=" + codigoMascota;

            fetch(apiUrl)
              .then(response => {
                if (!response.ok) {
                  throw new Error(`Error en la solicitud: ${response.statusText}`);
                }
                return response.json();
              })
              .then(data => {
                // Verifica si la respuesta de la API es verdadera
                if (data.status === 1) {
                  // Aquí puedes actualizar el contenido de tu página con los datos de la mascota
                  const nombreMascota = data.info[0].mascota.nmasc;
                  const fechanacimiento = data.info[0].mascota.nacim;
                  const Departamento = data.info[0].mascota.depto;
                  const Municipio = data.info[0].mascota.muni;
                  const direcciones = data.info[0].mascota.direccion;
                  const tel = data.info[0].mascota.telefono;
                  const mails = data.info[0].mascota.mail;

                  // Actualiza el contenido de tu página con el nombre de la mascota u otros datos necesarios
                  document.getElementById("Nom").innerText = nombreMascota;
                  document.getElementById("cod").innerText = codigoMascota;
                  document.getElementById("Fech").innerText = fechanacimiento;
                  document.getElementById("Dep").innerText = Departamento;
                  document.getElementById("Mun").innerText = Municipio;
                  document.getElementById("Direc").innerText = direcciones;
                  document.getElementById("Contc").innerText = tel;
                  document.getElementById("Ema").innerText = mails;

                  // Obtén la referencia al cuerpo de la tabla
                  const vacuna = document.getElementById("vacuna");

                  if (typeof data.info[0].vacuna === "object" && data.info[0].vacuna !== null) {
                    // Accede a las propiedades del objeto 'vacuna'
                    const newRow = document.createElement("tr");

                    const vacunaCell = document.createElement("td");
                    vacunaCell.textContent = data.info[0].vacuna[0].nombrevacuna; // Ajusta esto según la estructura de tus datos
                    newRow.appendChild(vacunaCell);

                    const fechaColocacionCell = document.createElement("td");
                    fechaColocacionCell.textContent = data.info[0].vacuna[0].fecha_creacion; // Ajusta esto según la estructura de tus datos
                    newRow.appendChild(fechaColocacionCell);

                    // Agrega la nueva fila al cuerpo de la tabla
                    const vacunaTableBody = document.querySelector('container');
                    vacunaTableBody.appendChild(newRow);
                  }
                  else {
                    console.error("El campo 'vacuna' no es un array en la respuesta de la API.");
                  }
                  // Verifica si vacuna es un array antes de intentar iterar sobre él
                  /*if (Array.isArray(data.info[0].vacuna)) {
                    // Recorre el array de vacunas y agrega filas a la tabla
                    data.info[0].vacuna.forEach(vacuna => {
                      const newRow = document.createElement("tr");

                      const vacunaCell = document.createElement("nombrevacuna");
                      vacunaCell.textContent = vacuna.nombrevacuna; // Ajusta esto según la estructura de tus datos
                      newRow.appendChild(vacunaCell);

                      const fechaColocacionCell = document.createElement("fecha_creacion");
                      fechaColocacionCell.textContent = vacuna.fecha_creacion; // Ajusta esto según la estructura de tus datos
                      newRow.appendChild(fechaColocacionCell);

                      // Agrega la nueva fila al cuerpo de la tabla
                      vacunaTableBody.appendChild(newRow);
                    });
                  } else {
                    console.error("El campo 'vacuna' no es un array en la respuesta de la API.");
                  }*/

                } else {
                  alert("Error al obtener los datos de la mascota.");
                }
              })
              .catch(error => {
                console.error("Error al obtener datos", error);
              });
          } else {
            alert("Código de mascota no proporcionado en la URL.");
          }

        </script>


</body>

</html>